# Moedim.Mapper

C# Source Generator Object Mapper - Convention-based and Attribute-based mapping with compile-time code generation

[![Build Status](https://img.shields.io/badge/build-passing-brightgreen)]()
[![NuGet](https://img.shields.io/badge/nuget-v1.0.0-blue)]()
[![License](https://img.shields.io/badge/license-MIT-green)]()

![Stand With Israel](./img/IStandWithIsrael.png)

> This is a Hebrew word that translates "feast" or "appointed time."
> "Appointed times" refers to HaSham's festivals in Vayikra/Leviticus 23rd.
> The feasts are "signals and signs" to help us know what is on the heart of HaShem.

## Features

- **Compile-Time Code Generation** - Zero runtime overhead with source generators
- **Attribute-Based Mapping** - Simple, declarative mapping configuration
- **Type-Safe** - Full compile-time type checking and IntelliSense support
- **Null-Safe** - Handles nullable reference types correctly
- **Collection Support** - Maps List, Array, IEnumerable, and Dictionary types
- **Custom Property Mapping** - Map properties with different names
- **Ignored Properties** - Exclude specific properties from mapping
- **High Performance** - Faster than reflection-based mappers
- **Multi-Framework Support** - Targets .NET 6.0, .NET 7.0, and .NET 8.0

## Hire me

Please send [email](mailto:info@kingdavidconsulting.com) if you consider to **hire me**.

[![buymeacoffee](https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png)](https://www.buymeacoffee.com/vyve0og)

## Give a Star! :star:

If you like or are using this project to learn or start your solution, please give it a star. Thanks!

## Installation

```bash
dotnet add package Moedim.Mapper
```

## Quick Start

### Basic Attribute-Based Mapping

```csharp
using Moedim.Mapper;

// Source class
public class User
{
    public string Name { get; set; }
    public int Age { get; set; }
    public string Email { get; set; }
}

// Destination class with MapFrom attribute
[MapFrom(typeof(User))]
public class UserDto
{
    public string Name { get; set; }
    public int Age { get; set; }
    public string Email { get; set; }
}

// Usage
var user = new User { Name = "John", Age = 30, Email = "john@example.com" };
var dto = user.ToUserDto(); // Extension method generated automatically
```

### Custom Property Mapping

```csharp
public class Product
{
    public string ProductName { get; set; }
    public decimal Price { get; set; }
}

[MapFrom(typeof(Product))]
public class ProductDto
{
    [MapProperty("ProductName")]  // Map from different property name
    public string Name { get; set; }
    public decimal Price { get; set; }
}

// Usage
var product = new Product { ProductName = "Laptop", Price = 1299.99m };
var dto = product.ToProductDto();
// dto.Name will contain "Laptop"
```

### Ignoring Properties

```csharp
public class Employee
{
    public string Name { get; set; }
    public decimal Salary { get; set; }
    public string SocialSecurityNumber { get; set; }
}

[MapFrom(typeof(Employee))]
public class EmployeeDto
{
    public string Name { get; set; }

    [IgnoreProperty]  // Excluded from mapping
    public decimal Salary { get; set; }

    [IgnoreProperty]  // Excluded from mapping
    public string SocialSecurityNumber { get; set; }
}
```

### Collection Mapping

```csharp
public class Team
{
    public string Name { get; set; }
    public List<string> Members { get; set; }
}

[MapFrom(typeof(Team))]
public class TeamDto
{
    public string Name { get; set; }
    public List<string> Members { get; set; }
}

// Collections are mapped automatically
var team = new Team
{
    Name = "Dev Team",
    Members = new List<string> { "Alice", "Bob" }
};
var dto = team.ToTeamDto();
```

### Bidirectional Mapping

```csharp
// Map in both directions
[MapTo(typeof(PersonDto))]
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
}

[MapFrom(typeof(Person))]
public class PersonDto
{
    public string Name { get; set; }
    public int Age { get; set; }
}

// Now both directions work
var person = new Person { Name = "Alice", Age = 25 };
var dto = person.ToPersonDto();
var personAgain = dto.ToPerson();
```

## Generated Code Example

For the basic User/UserDto example, Moedim.Mapper generates:

```csharp
// <auto-generated/>
#nullable enable

using TestNamespace;

namespace TestNamespace;

/// <summary>
/// Extension methods for mapping User to UserDto.
/// </summary>
public static class UserToUserDtoMappingExtensions
{
    /// <summary>
    /// Maps User to UserDto.
    /// </summary>
    public static UserDto? ToUserDto(this User? source)
    {
        if (source is null)
            return null;

        return new UserDto
        {
            Name = source.Name,
            Age = source.Age,
            Email = source.Email
        };
    }
}
```

## Performance

Moedim.Mapper uses source generators to create mapping code at compile time, resulting in:

- **Zero reflection overhead** - Direct property assignments
- **Similar to manual mapping** - Generated code is as fast as hand-written code
- **No runtime initialization** - Ready to use immediately
- **Optimized for collections** - Efficient collection transformations

Run benchmarks with:

```bash
dotnet run --project tests/Moedim.Mapper.Performance.Tests -c Release
```

## Advanced Features

### Fluent Configuration Interface

```csharp
public interface IMapperConfigurationBuilder
{
    IMappingExpression<TSource, TDestination> CreateMap<TSource, TDestination>();
}

public interface IMappingExpression<TSource, TDestination>
{
    IMappingExpression<TSource, TDestination> ForMember<TMember>(
        Expression<Func<TDestination, TMember>> destinationMember,
        Action<IMemberConfigurationExpression<TSource, TDestination, TMember>> memberOptions);
}
```

### Supported Type Conversions

- Direct type matches
- Nullable value types (int to int?, etc.)
- Collection types (Array, List, IEnumerable)
- Numeric conversions (int to long, etc.)

## Requirements

- .NET 6.0, 7.0, or 8.0
- C# 11 or later (for consuming projects)
- Visual Studio 2022 or Rider (for best IDE support)

## Project Structure

- **Moedim.Mapper** - Core library with attributes and interfaces
- **Moedim.Mapper.SourceGenerator** - Roslyn source generator implementation
- **Moedim.Mapper.Tests** - Unit tests
- **Moedim.Mapper.SourceGenerator.Tests** - Generator-specific tests
- **Moedim.Mapper.Performance.Tests** - Performance benchmarks
- **Moedim.Mapper.Sample** - Example usage

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

Built with:

- [Roslyn Source Generators](https://github.com/dotnet/roslyn)
- [xUnit](https://xunit.net/)
- [BenchmarkDotNet](https://benchmarkdotnet.org/)
- [FluentAssertions](https://fluentassertions.com/)

## Version History

### 1.0.0 (Initial Release)

- Attribute-based mapping with `[MapFrom]` and `[MapTo]`
- Custom property mapping with `[MapProperty]`
- Property exclusion with `[IgnoreProperty]`
- Collection mapping support
- Null-safe code generation
- Multi-framework support (.NET 6.0, 7.0, 8.0)
